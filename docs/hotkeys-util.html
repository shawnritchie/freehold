<!DOCTYPE html>

<html>
<head>
  <title>hotkeys-util.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page">
            
              
              <a class="source" href="hotkeys-util.html">
                hotkeys-util.js
              </a>
            
              
              <a class="source" href="utility.html">
                utility.js
              </a>
            
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>hotkeys-util.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              <h2 id="library">Library</h2>

            </div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>Github - <a href="https://github.com/puppets/marionette-cookbook">https://github.com/puppets/marionette-cookbook</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
;(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(root, $)</span> </span>{
   <span class="hljs-keyword">var</span> valid_modifiers = [<span class="hljs-string">'alt'</span>, <span class="hljs-string">'ctrl'</span>, <span class="hljs-string">'meta'</span>, <span class="hljs-string">'shift'</span>];

    <span class="hljs-keyword">var</span> special_keys = {
        <span class="hljs-number">8</span>: <span class="hljs-string">'backspace'</span>, <span class="hljs-number">9</span>: <span class="hljs-string">'tab'</span>, <span class="hljs-number">13</span>: <span class="hljs-string">'return'</span>, <span class="hljs-number">16</span>: <span class="hljs-string">'shift'</span>, <span class="hljs-number">17</span>: <span class="hljs-string">'ctrl'</span>, <span class="hljs-number">18</span>: <span class="hljs-string">'alt'</span>, <span class="hljs-number">19</span>: <span class="hljs-string">'pause'</span>,
        <span class="hljs-number">20</span>: <span class="hljs-string">'capslock'</span>, <span class="hljs-number">27</span>: <span class="hljs-string">'esc'</span>, <span class="hljs-number">32</span>: <span class="hljs-string">'space'</span>, <span class="hljs-number">33</span>: <span class="hljs-string">'pageup'</span>, <span class="hljs-number">34</span>: <span class="hljs-string">'pagedown'</span>, <span class="hljs-number">35</span>: <span class="hljs-string">'end'</span>, <span class="hljs-number">36</span>: <span class="hljs-string">'home'</span>,
        <span class="hljs-number">37</span>: <span class="hljs-string">'left'</span>, <span class="hljs-number">38</span>: <span class="hljs-string">'up'</span>, <span class="hljs-number">39</span>: <span class="hljs-string">'right'</span>, <span class="hljs-number">40</span>: <span class="hljs-string">'down'</span>, <span class="hljs-number">45</span>: <span class="hljs-string">'insert'</span>, <span class="hljs-number">46</span>: <span class="hljs-string">'del'</span>,
        <span class="hljs-number">96</span>: <span class="hljs-string">'0'</span>, <span class="hljs-number">97</span>: <span class="hljs-string">'1'</span>, <span class="hljs-number">98</span>: <span class="hljs-string">'2'</span>, <span class="hljs-number">99</span>: <span class="hljs-string">'3'</span>, <span class="hljs-number">100</span>: <span class="hljs-string">'4'</span>, <span class="hljs-number">101</span>: <span class="hljs-string">'5'</span>, <span class="hljs-number">102</span>: <span class="hljs-string">'6'</span>, <span class="hljs-number">103</span>: <span class="hljs-string">'7'</span>,
        <span class="hljs-number">104</span>: <span class="hljs-string">'8'</span>, <span class="hljs-number">105</span>: <span class="hljs-string">'9'</span>, <span class="hljs-number">106</span>: <span class="hljs-string">'*'</span>, <span class="hljs-number">107</span>: <span class="hljs-string">'+'</span>, <span class="hljs-number">109</span>: <span class="hljs-string">'-'</span>, <span class="hljs-number">110</span>: <span class="hljs-string">'.'</span>, <span class="hljs-number">111</span> : <span class="hljs-string">'/'</span>,
        <span class="hljs-number">112</span>: <span class="hljs-string">'f1'</span>, <span class="hljs-number">113</span>: <span class="hljs-string">'f2'</span>, <span class="hljs-number">114</span>: <span class="hljs-string">'f3'</span>, <span class="hljs-number">115</span>: <span class="hljs-string">'f4'</span>, <span class="hljs-number">116</span>: <span class="hljs-string">'f5'</span>, <span class="hljs-number">117</span>: <span class="hljs-string">'f6'</span>, <span class="hljs-number">118</span>: <span class="hljs-string">'f7'</span>, <span class="hljs-number">119</span>: <span class="hljs-string">'f8'</span>,
        <span class="hljs-number">120</span>: <span class="hljs-string">'f9'</span>, <span class="hljs-number">121</span>: <span class="hljs-string">'f10'</span>, <span class="hljs-number">122</span>: <span class="hljs-string">'f11'</span>, <span class="hljs-number">123</span>: <span class="hljs-string">'f12'</span>, <span class="hljs-number">144</span>: <span class="hljs-string">'numlock'</span>, <span class="hljs-number">145</span>: <span class="hljs-string">'scroll'</span>, <span class="hljs-number">191</span>: <span class="hljs-string">'/'</span>, <span class="hljs-number">224</span>: <span class="hljs-string">'meta'</span>,
        <span class="hljs-number">186</span>: <span class="hljs-string">';'</span>,
        <span class="hljs-number">187</span>: <span class="hljs-string">'+'</span>,
        <span class="hljs-number">188</span>: <span class="hljs-string">','</span>,
        <span class="hljs-number">189</span>: <span class="hljs-string">'-'</span>,
        <span class="hljs-number">190</span>: <span class="hljs-string">'.'</span>,
        <span class="hljs-number">192</span>: <span class="hljs-string">'`'</span>,
        <span class="hljs-number">219</span>: <span class="hljs-string">'['</span>,
        <span class="hljs-number">220</span>: <span class="hljs-string">'\\'</span>,
        <span class="hljs-number">221</span>: <span class="hljs-string">']'</span>,
        <span class="hljs-number">222</span>: <span class="hljs-string">'\''</span>,
    };

    <span class="hljs-keyword">var</span> eventsNamespace = {};

    <span class="hljs-keyword">var</span> keyMatches = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e, key)</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">String</span>.fromCharCode(e.which).toLowerCase() == key
            || special_keys[e.which] == key;
    };

    <span class="hljs-keyword">var</span> modifierMatches = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e, modifiers)</span> </span>{
        <span class="hljs-keyword">var</span> hasModifier = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(m)</span> </span>{
            <span class="hljs-keyword">return</span> e[m + <span class="hljs-string">'Key'</span>];
        };

        <span class="hljs-keyword">return</span> _.chain(modifiers)
                .intersection(valid_modifiers)
                .all(hasModifier)
                .value();
    };

    <span class="hljs-keyword">var</span> matches = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e, key, modifiers)</span> </span>{
        <span class="hljs-keyword">return</span> keyMatches(e, key)
            &amp;&amp; modifierMatches(e, modifiers);
    };

    <span class="hljs-keyword">var</span> buildHandler = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(key, modifiers, callback)</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span> </span>{
            <span class="hljs-keyword">if</span> (<span class="hljs-regexp">/textarea|select/i</span>.test(e.target.nodeName) || e.target.type === <span class="hljs-string">"text"</span>) {
                <span class="hljs-keyword">return</span>;
            }

            <span class="hljs-keyword">if</span> (matches(e, key, modifiers)) {
                e.stopPropagation();
                e.preventDefault();
                callback(<span class="hljs-built_in">arguments</span>);
            }
        };
    };

    <span class="hljs-keyword">var</span> bind = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(events, context, namespace)</span> </span>{
        _.each(events, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(method, trigger)</span> </span>{
            <span class="hljs-keyword">if</span> (_.isFunction(context[method])) {
                <span class="hljs-keyword">var</span> parts = trigger.split(<span class="hljs-regexp">/\s*\+\s*/</span>),
                    key = _.last(parts),
                    modifiers = _.initial(parts),
                    callback = _.bind(context[method], context);

                    <span class="hljs-keyword">if</span> (eventsNamespace[namespace]) {
                      eventsNamespace[namespace].push(buildHandler(key, modifiers, callback));
                    } <span class="hljs-keyword">else</span> {
                      eventsNamespace[namespace] = [buildHandler(key, modifiers, callback)];
                    }
            }
        });
        <span class="hljs-keyword">return</span> context;
    };

    <span class="hljs-keyword">var</span> unbind = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(events, context, namespace)</span> </span>{
        <span class="hljs-keyword">delete</span> eventsNamespace[namespace];
    };

    <span class="hljs-keyword">var</span> onKeyup = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span> </span>{
        _.each(eventsNamespace, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(namespace)</span> </span>{
          _.each(namespace, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(callback)</span> </span>{
            callback(e);
          });
        });
    };

    $(<span class="hljs-built_in">document</span>).on(<span class="hljs-string">'keyup'</span>, onKeyup);

    root.HotKeys = {
        <span class="hljs-string">'bind'</span>: bind,
        <span class="hljs-string">'unbind'</span>: unbind
    };
}(<span class="hljs-built_in">window</span>, $))</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
